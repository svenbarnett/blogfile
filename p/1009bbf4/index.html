<!DOCTYPE HTML><html><head><meta charset="utf-8"><title>gulp-imagemin在压缩图片 | 人间日常 | 所行皆过往，所愿皆成真</title><meta name="author" content="SIWEN.PENG"><meta name="description" content="使用gulp进行图片压缩，借助gulp-imagemin插件"><meta name="keywords" content="gulp-imagemin,压缩图片,gulp,psw,彭思文,siwen,思文,sven,java,study,solution,blog"><meta id="viewport" name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta property="og:title" content="gulp-imagemin在压缩图片"><meta property="og:site_name" content="人间日常"><meta property="og:image" content="ppp"><link href="/favicon.ico" rel="icon"><link rel="alternate" href="/atom.xml" title="人间日常" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="blog"><div class="content"><header><div class="site-branding"><h1 class="site-title"><a href="/">人间日常</a></h1><p class="site-description">所行皆过往，所愿皆成真</p></div><nav class="site-navigation"><ul></ul></nav></header><main class="site-main posts-loop"><article><h3 class="article-title"><span>gulp-imagemin在压缩图片</span></h3><div class="article-top-meta"><span class="posted-on"><a target="_blank" href="//p/1009bbf4/" rel="bookmark noopener"><time class="entry-date published" datetime="2021-11-16T14:35:58.000Z">2021-11-16</time></a></span></div><div class="article-content"><div class="entry"><p>经过各种研（bai）究（du），找到了一种方案：采用 <code>gulp + gulp-imagemin</code> ，对图片进行压缩，结合 hexo 进行对应图片压缩。</p><span id="more"></span><h3 id="安装"><a class="markdownIt-Anchor" href="#安装">#</a> 安装</h3><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">npm</span> <span class="token function">install</span> gulp --save-dev</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">npm</span> <span class="token function">install</span> gulp-imagemin --save-dev</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">npm</span> <span class="token function">install</span> imagemin-pngquant --save-dev</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 当然也可以 --save  记得要给 gulp 全局安装下，npm 命令不行，就是用 cnpm</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">npm</span> <span class="token function">install</span> gulp <span class="token parameter variable">-g</span> <span class="token comment"># 只有 gulp 要全局安装下</span></pre></td></tr></table></figure><h3 id="gulpfile"><a class="markdownIt-Anchor" href="#gulpfile">#</a> gulpfile</h3><p>在 package.json 同名目录下，增加 gulpfile.js 对应的入口 js 文件</p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gulp <span class="token keyword">from</span> <span class="token string">'gulp'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> imagemin <span class="token keyword">from</span> <span class="token string">'gulp-imagemin'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> pngquant <span class="token keyword">from</span> <span class="token string">'imagemin-pngquant'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 定义一个任务 第一个参数为名称，后面时要执行的动作</span></pre></td></tr><tr><td data-num="6"></td><td><pre>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'minify-images'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'public/p/**/*.&#123;JPG,jpg,PNG,png,GIF,gif,SVG,svg,JPEG,jpeg&#125;'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">imagemin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>			<span class="token literal-property property">optimizationLevel</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>			<span class="token literal-property property">progressive</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>			<span class="token literal-property property">usa</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token function">pngquant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'public/p/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 定义 default ，后面将多个任务序列化并行执行，我们只有一个</span></pre></td></tr><tr><td data-num="17"></td><td><pre>gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> gulp<span class="token punctuation">.</span><span class="token function">series</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token string">'minify-images'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"----------gulp Finished----------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>执行命令 <code>gulp</code> 默认情况下，代表 <code>gulp default</code> 就执行你上面的 default 任务</p><p>当然你也可以制定任务名称： <code>gulp minify-images</code> 执行指定 task</p><p>然后再 hexo 状态下：</p><figure class="highlight sh"><figcaption data-lang="sh"></figcaption><table><tr><td data-num="1"></td><td><pre>hexo clean </pre></td></tr><tr><td data-num="2"></td><td><pre>hexo g</pre></td></tr><tr><td data-num="3"></td><td><pre>gulp</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 输出如下：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span><span class="token number">22</span>:46:42<span class="token punctuation">]</span> Using gulpfile ~/Desktop/blogfile/gulpfile.js</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span><span class="token number">22</span>:46:42<span class="token punctuation">]</span> Starting <span class="token string">'default'</span><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span><span class="token number">22</span>:46:42<span class="token punctuation">]</span> Starting <span class="token string">'minify-images'</span><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">[</span><span class="token number">22</span>:46:42<span class="token punctuation">]</span> Finished <span class="token string">'minify-images'</span> after <span class="token number">74</span> ms</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">[</span><span class="token number">22</span>:46:42<span class="token punctuation">]</span> Finished <span class="token string">'default'</span> after <span class="token number">99</span> ms</pre></td></tr></table></figure><p>那说明成功了</p><h3 id="遇到的坑"><a class="markdownIt-Anchor" href="#遇到的坑">#</a> 遇到的坑</h3><ul><li>引入语法问题，插件需要使用 es6 语法，故此你的 package.json 需要增加一个参数 <code>&quot;type&quot;: &quot;module&quot;</code> 如此你可以再 gulpfile.js 中使用 es6 的 import 语法</li></ul></div></div><div class="article-footer"><div class="article-meta pull-left"><span class="post-tags"><i class="icon-tags"></i> <a href="/tags/gulp/">gulp</a><a href="/tags/压缩图片/">压缩图片</a><a href="/tags/gulp-imagemin/">gulp-imagemin</a></span></div></div></article></main><footer class="site-footer"><p class="site-info"><br>&copy; 2023 SIWEN.PENG</p></footer></div></div></body></html>