<!DOCTYPE HTML><html><head><meta charset="utf-8"><title>gulp-imagemin在压缩图片 | 人间日常 | 所行皆过往，所愿皆成真</title><meta name="author" content="SIWEN.PENG"><meta name="description" content="使用gulp进行图片压缩，借助gulp-imagemin插件"><meta name="keywords" content="gulp-imagemin,压缩图片,gulp,psw,彭思文,siwen,思文,sven,java,study,solution,blog"><meta id="viewport" name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta property="og:title" content="gulp-imagemin在压缩图片"><meta property="og:site_name" content="人间日常"><meta property="og:image" content="ppp"><link href="/favicon.ico" rel="icon"><link rel="alternate" href="/atom.xml" title="人间日常" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="blog"><div class="content"><header><div class="site-branding"><h1 class="site-title"><a href="/">人间日常</a></h1><p class="site-description">所行皆过往，所愿皆成真</p></div><nav class="site-navigation"><ul><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/pics">图记</a></li></ul></nav></header><main class="site-main posts-loop"><article><h3 class="article-title"><span>gulp-imagemin在压缩图片</span></h3><div class="article-top-meta"><span class="posted-on"><a target="_blank" href="//p/1009bbf4/" rel="bookmark noopener"><time class="entry-date published" datetime="2021-11-16T14:35:58.000Z">2021-11-16</time></a></span></div><div class="article-content"><div class="entry"><p>经过各种研（bai）究（du），找到了一种方案：采用 <code>gulp + gulp-imagemin</code> ，对图片进行压缩，结合 hexo 进行对应图片压缩。</p><span id="more"></span><h3 id="安装"><a class="markdownIt-Anchor" href="#安装">#</a> 安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp --save-dev</span><br><span class="line">npm install gulp-imagemin --save-dev</span><br><span class="line">npm install imagemin-pngquant --save-dev</span><br><span class="line"><span class="comment"># 当然也可以--save  记得要给gulp全局安装下，npm命令不行，就是用cnpm</span></span><br><span class="line">npm install gulp -g <span class="comment"># 只有gulp要全局安装下</span></span><br></pre></td></tr></table></figure><h3 id="gulpfile"><a class="markdownIt-Anchor" href="#gulpfile">#</a> gulpfile</h3><p>在 package.json 同名目录下，增加 gulpfile.js 对应的入口 js 文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gulp <span class="keyword">from</span> <span class="string">&#x27;gulp&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> imagemin <span class="keyword">from</span> <span class="string">&#x27;gulp-imagemin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> pngquant <span class="keyword">from</span> <span class="string">&#x27;imagemin-pngquant&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个任务 第一个参数为名称，后面时要执行的动作</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-images&#x27;</span>, <span class="keyword">function</span> (<span class="params">done</span>) &#123;</span><br><span class="line">    gulp.<span class="title function_">src</span>(<span class="string">&#x27;public/p/**/*.&#123;JPG,jpg,PNG,png,GIF,gif,SVG,svg,JPEG,jpeg&#125;&#x27;</span>)</span><br><span class="line">		.<span class="title function_">pipe</span>(<span class="title function_">imagemin</span>(&#123;</span><br><span class="line">			<span class="attr">optimizationLevel</span>: <span class="number">3</span>,</span><br><span class="line">			<span class="attr">progressive</span>: <span class="literal">true</span>,</span><br><span class="line">			<span class="attr">usa</span>:[<span class="title function_">pngquant</span>()]</span><br><span class="line">		&#125;))</span><br><span class="line">		.<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;public/p/&#x27;</span>))</span><br><span class="line">    <span class="title function_">done</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 定义default ，后面将多个任务序列化并行执行，我们只有一个</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;default&#x27;</span>, gulp.<span class="title function_">series</span>(gulp.<span class="title function_">parallel</span>(<span class="string">&#x27;minify-images&#x27;</span>)), <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;----------gulp Finished----------&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>执行命令 <code>gulp</code> 默认情况下，代表 <code>gulp default</code> 就执行你上面的 default 任务</p><p>当然你也可以制定任务名称： <code>gulp minify-images</code> 执行指定 task</p><p>然后再 hexo 状态下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo clean </span><br><span class="line">hexo g</span><br><span class="line">gulp</span><br><span class="line"><span class="comment"># 输出如下：</span></span><br><span class="line">[22:46:42] Using gulpfile ~/Desktop/blogfile/gulpfile.js</span><br><span class="line">[22:46:42] Starting <span class="string">&#x27;default&#x27;</span>...</span><br><span class="line">[22:46:42] Starting <span class="string">&#x27;minify-images&#x27;</span>...</span><br><span class="line">[22:46:42] Finished <span class="string">&#x27;minify-images&#x27;</span> after 74 ms</span><br><span class="line">[22:46:42] Finished <span class="string">&#x27;default&#x27;</span> after 99 ms</span><br></pre></td></tr></table></figure><p>那说明成功了</p><h3 id="遇到的坑"><a class="markdownIt-Anchor" href="#遇到的坑">#</a> 遇到的坑</h3><ul><li>引入语法问题，插件需要使用 es6 语法，故此你的 package.json 需要增加一个参数 <code>&quot;type&quot;: &quot;module&quot;</code> 如此你可以再 gulpfile.js 中使用 es6 的 import 语法</li></ul></div></div><div class="article-footer"><div class="article-meta pull-left"><span class="post-tags"><i class="icon-tags"></i> <a href="/tags/gulp/">gulp</a><a href="/tags/压缩图片/">压缩图片</a><a href="/tags/gulp-imagemin/">gulp-imagemin</a></span></div></div></article></main><footer class="site-footer"><p class="site-info"><br>&copy; 2023 SIWEN.PENG</p></footer></div></div></body></html>